# 开发日志
登录信息：
## 一、导航栏设计  

1. 首页
2. 关于汪峰（获奖记录迁移到此）
3. 行程信息
4. 音乐作品
5. 图片画廊
6. 峰言峰语
7. 峰回路转
8. 资料科普
9. 关于本站

## 1.首页

<img src="/Users/yger/Library/Application Support/typora-user-images/image-20251005215851220.png" alt="image-20251005215851220" style="zoom:25%;" />

维持现状，等全部开发好之后再修改。

## 2.关于汪峰

## 3.行程信息

目前只有演唱会，音乐节，商演拼盘，综艺晚会，其他

## 4.音乐作品

## 5.图片画廊

## 6.峰言峰语

- 汪峰博客
- 汪峰语录
- 访谈记录

## 7.峰回路转

- 闲聊汪峰
- 歌曲赏析
- 逸闻趣事
- 媒体报道

## 8.资料科普

- 汪峰数据
- 辟谣考证
- 演唱会资料
- 歌曲资料
- 乐队资料

## 9.关于本站



# 二、登陆设计

## 1.角色权限设计

角色分为：超级管理员、管理员、用户、游客
游客可以查看所有页面，（之前能点赞，现在不能点赞）
用户可以点赞，评论，写文章，发布行程，但是发布之后需要等待审核。
管理员可以写文章，发布行程，以及审核用户发布的文章和行程，可以做一定的修改。或者直接驳回。不能删除现有内容。
超级管理员可以管理修改删除任何文章和行程。

## 2.管理页面









# 三、发布功能设计

## 1.文章发布



  1. Markdown 编辑器 - 使用 @uiw/react-md-editor，支持实时预览

  2. 文章信息管理 - 标题、作者、分类、标签、摘要等

  3. 预览功能 - 发布前预览文章效果

  4. 统计功能 - 浏览次数、点赞数等

     

文章存mysql



写完文章可以选择发布到哪一个模块，首先选择一级目录，峰言峰语、峰回路转、资料科普，然后再选择二级目录。

文章文类信息：

峰言峰语

- 汪峰博客
- 汪峰语录
- 访谈记录

峰回路转

- 闲聊汪峰
- 歌曲赏析
- 逸闻趣事
- 媒体报道

资料科普

- 汪峰数据
- 辟谣考证
- 演唱会资料
- 歌曲资料
- 乐队资料



普通用户发布文章之后会提交给管理员进行审核。




登陆按钮放到最右边，登陆按钮的左边为“发布”按钮，发布功能支持写文章，发布行程。

我希望写文章功能，（如果你觉得实现起来麻烦，那就把本地所有文章都传到mysql里面，后续统一从mysql里渲染文章，不知道这样是否可行。
1. 


————————————————————————————————————
————————————————————————————————————

请把演出信息标签栏 改为 行程信息
行程信息总体以现在的时间轴形式，

点击行程信息，会出现总时间轴，时间轴的中间是圆点，但是只有演唱会才会显示数字，其他行程则是实心圆。
有一个和其他标签页类似的分类按钮，可以单独查看演唱会、音乐节、商演、综艺、其他 的时间轴
每一个行程信息还是以卡片的形式展示，卡片左侧上方是日期，下面依次是城市、具体地点、具体事项，我希望卡片的最右侧展示一张竖向的图片，图片的地址统一采用相信未来巡演海报，后续再做更改

————————————————————————————
请整理我的项目代码，后端放进backend里，前端放进frontend里，前端页面有些有文件路径的，请一并修改。
public文件夹里 有些是数据，比如演唱会数据，奖项数据，这些放在原地，后续可能转移到数据中的表里面。有些是网站基础的图片，或者基础的文字，这些放进frontend合适的位置。


把右上角的三个融为一体，变成一个默认的图标，点击图标出现下拉框：第一个是写文章，第二个是发布行程，第三个是审核，第四个是管理，第五个是个人资料，第六个是退出登陆，你先实现写文章和退出登陆，其他的后续实现。

首先把行程页的获取门票信息功能去掉。然后增加 发布行程功能，可以选择种类：演唱会 音乐节等，时间，地点，等等。这些信息存储到本地对应的位置，和原来的一致，或者演唱会一个文件，音乐节一个文件。另一个重点是可以上传图片，上传的图片保存到项目目录下的一个文件夹里。


下一步： 更新数据库存储方式。行程信息统计方式，添加每首歌的详细信息，内嵌b站、优酷

浅色模式下不要这样的黑底，请换成其他的类似于行程卡片这样的紫色底。另外，把图片画廊里，被选择的那个按钮的字体颜色改成白色，然后统一每一个页面的分类按钮样式为图片画廊页面那样

事件的概念， 演唱会行程、演唱会视频、歌曲的现场
专辑。作品的概念，歌曲鉴赏绑定到作品页面

给我的网站新加一个页面，布局和峰言峰语类似，页面暂时叫视频存档，下面也是有几个分类，然后是四列卡片的布局，卡片布局和峰言峰语的文章卡片布局类似，封面暂时也用默认的渐变，后续再考虑，每一个卡片点开，就会跳转到一个页面，和文章页面有点类似，但是中间是通过B站提供的官方播放器JS库，可以播放对应的b站视频

2. 重启后端
cd backend
python3 start.py
后端启动后，数据库表会自动创建（通过 SQLAlchemy）。
3. 测试标签系统
cd backend
python3 test_tag_system.py
4. 访问测试
打开浏览器访问：http://localhost:1997/#/admin/schedules/create
尝试在标签输入框中输入"花"，应该能看到搜索功能
可以创建新标签
5. API 文档
访问 http://localhost:1994/docs 查看所有标签相关的 API 接口。
📋 后续开发建议
阶段 1：预构建标签库
创建常用标签，在后端执行：
from app.database import SessionLocal
from app.services.tag_service import TagService

db = SessionLocal()
tag_service = TagService(db)

common_tags = [
    "单曲《花火》", "单曲《春天里》", "单曲《飞得更高》",
    "专辑《花火》", "专辑《生来彷徨》",
    "UNFOLLOW巡回演唱会", "摇滚", "民谣", "现场", "MV"
]

tag_service.batch_create_tags(common_tags)
db.close()
阶段 2：集成到其他模块
更新视频、文章、图片等创建表单使用 TagInputWithSearch
在详情页底部添加 TagList 组件
点击标签时打开 TagContentModal

阶段 3：实现标签内容聚合
需要实现 TagContentModal 的 onLoadContents 函数，根据标签 ID 获取实际的视频、文章、图片详情。
⚠️ 注意事项
MySQL 版本：需要 MySQL 5.7+ 支持外键约束
字符集：使用 utf8mb4 支持中文和特殊字符
权限：确保数据库用户有创建表的权限
向后兼容：schedules 表的 tags 字段保留，新系统使用关联表
现在标签系统已经完全实现并可以使用了！试试在行程创建页面输入标签吧！🎉




在后端界面中，请按照文章列表的样式，实现行程列表的功能，行程列表里要包含：行程主题（第一列）、城市、场馆、日期、发布状态。 


我的视频存档的卡片样式应该和资料科普、峰迷荟萃、峰言峰语的文章卡片是类似的宽高，但现在有点不一样，视频卡片是：封面、标题、两行正文、一行空行、作者和时间，文章卡片是：封面、标题、两行正文、作者和时间、一行空行。多多少少都有问题，请统一修改为：封面、标题、两行正文、作者和时间，因此卡片的总高度会减少一行


修改后台管理页面，分为两个后台，
一个是用户后台，就是普通用户登陆进来的界面，包含：修改资料、发布文章、发布行程、发布视频、发布图片，我的发布。的侧边栏：第一项是






✅ 完成的工作总结
1. 修复行程列表跳转问题
✅ 创建了 ScheduleEdit.tsx 组件（基于 ScheduleCreate，支持加载现有数据并编辑）
✅ 在 App.tsx 中添加了行程编辑路由：/admin/schedules/edit/:id
✅ 现在点击行程列表中的行程标题可以正常跳转到编辑页面
2. 创建设计文档
📄 docs/后台列表设计方案.md
详细描述了列表页面的完整设计方案，包括：
设计原则（统一视觉风格、功能完备性、性能优化）
页面结构（三层布局：标题栏、筛选栏、数据表格）
功能模块详解
顶部标题栏（图标、标题、数量徽章、创建按钮）
筛选搜索栏（搜索框、分类筛选、状态筛选）
数据表格（可排序表头、数据行设计、状态徽章）
筛选和排序逻辑（使用 useMemo 优化）
空状态设计
主题适配（Light/Dark 模式）
响应式设计
交互细节
数据流和状态管理
最佳实践
📄 docs/后台发布功能设计方案.md
详细描述了发布功能的完整设计方案，包括：
设计原则（统一视觉风格、布局原则、交互原则）
统一布局框架
三个发布页面的详细设计
文章发布/编辑：允许页面滚动，富文本编辑器
行程发布/编辑：3列网格布局，图片上传，日期三联选择器
视频发布：固定高度容器，URL 输入
通用功能组件
标签输入组件（TagInputWithSearch）
富文本编辑器（RichTextEditor）
表单验证
消息反馈（成功/错误提示）
提交逻辑（JSON/FormData）
编辑功能（数据加载、更新提交）
主题适配
响应式设计
API 集成
最佳实践
3. 主要特性
行程编辑组件的关键功能：
从 URL 参数获取行程 ID
加载现有行程数据并填充表单
支持修改所有字段（主题、分类、城市、场馆、日期、描述、标签）
支持更换行程海报图片
保存更改后跳转回列表页
加载状态显示（Loader2 动画）
错误处理和成功提示
两份文档的价值：
📚 为未来开发提供完整的参考指南
🎨 确保设计风格的一致性
🔧 降低新功能开发的学习成本
📝 记录设计决策和最佳实践
所有工作已完成，行程列表的跳转问题已修复，文档也已创建完毕！🎉