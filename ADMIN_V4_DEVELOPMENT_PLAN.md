# ğŸ¨ æ–°åå°ç³»ç»Ÿå¼€å‘è®¡åˆ’ - å¤ç”¨ç°æœ‰UI

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**ç›®æ ‡**: å¼€å‘æ–°çš„åå°ç®¡ç†ç³»ç»Ÿï¼Œå®ç°æƒé™ç®¡ç†ç³»ç»Ÿä¸­å®šä¹‰çš„æ‰€æœ‰åŠŸèƒ½
**çº¦æŸ**: å¤ç”¨ç°æœ‰å‰ç«¯UIç»„ä»¶åº“ï¼ˆReact + Tailwind + ç°æœ‰ç»„ä»¶ï¼‰
**èŒƒå›´**: å®Œæ•´çš„å†…å®¹ç®¡ç† + å®¡æ ¸ + ç”¨æˆ·ç®¡ç†

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             åå°ç®¡ç†ç³»ç»Ÿ (New Admin)                      â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å‰ç«¯å±‚ (React + Tailwind)                                â”‚
â”‚  â”œâ”€â”€ ç™»å½•é¡µé¢ (å¤ç”¨AuthContext)                          â”‚
â”‚  â”œâ”€â”€ å·¦ä¾§å¯¼èˆªèœå•                                        â”‚
â”‚  â”œâ”€â”€ å†…å®¹ç®¡ç†                                            â”‚
â”‚  â”‚   â”œâ”€â”€ æˆ‘çš„å†…å®¹                                       â”‚
â”‚  â”‚   â””â”€â”€ å®¡æ ¸é¢æ¿                                       â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·ç®¡ç†                                            â”‚
â”‚  â””â”€â”€ ç³»ç»Ÿè®¾ç½®                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ APIå±‚ (FastAPI)                                          â”‚
â”‚  â”œâ”€â”€ å†…å®¹ç«¯ç‚¹ (CRUD + å®¡æ ¸)                              â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·ç«¯ç‚¹ (ç®¡ç†)                                     â”‚
â”‚  â””â”€â”€ æ—¥å¿—ç«¯ç‚¹ (æŸ¥è¯¢)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•°æ®å±‚ (MySQL)                                           â”‚
â”‚  â”œâ”€â”€ å†…å®¹è¡¨ (articles, videos, etc)                     â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·è¡¨ (users)                                     â”‚
â”‚  â””â”€â”€ æ—¥å¿—è¡¨ (admin_logs)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

### å‰ç«¯ç›®å½•ç»“æ„

```
frontend/src/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ admin-v4/                    â† æ–°åå°ç³»ç»Ÿï¼ˆv4ï¼‰
â”‚       â”œâ”€â”€ index.tsx                 # å…¥å£
â”‚       â”œâ”€â”€ layout/
â”‚       â”‚   â”œâ”€â”€ AdminLayout.tsx       # ä¸»å¸ƒå±€ï¼ˆä¾§è¾¹æ +é¡¶éƒ¨ï¼‰
â”‚       â”‚   â”œâ”€â”€ Sidebar.tsx           # ä¾§è¾¹æ å¯¼èˆª
â”‚       â”‚   â””â”€â”€ Header.tsx            # é¡¶éƒ¨æ 
â”‚       â”œâ”€â”€ pages/
â”‚       â”‚   â”œâ”€â”€ Dashboard.tsx         # ä»ªè¡¨æ¿ï¼ˆæ¦‚è§ˆï¼‰
â”‚       â”‚   â”œâ”€â”€ MyContent.tsx         # æˆ‘çš„å†…å®¹åˆ—è¡¨
â”‚       â”‚   â”œâ”€â”€ ContentEditor.tsx     # å†…å®¹ç¼–è¾‘å™¨ï¼ˆé€šç”¨ï¼‰
â”‚       â”‚   â”œâ”€â”€ ReviewPanel.tsx       # å®¡æ ¸é¢æ¿
â”‚       â”‚   â”œâ”€â”€ UserManagement.tsx    # ç”¨æˆ·ç®¡ç†
â”‚       â”‚   â””â”€â”€ Settings.tsx          # ç³»ç»Ÿè®¾ç½®
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ ContentCard.tsx       # å†…å®¹å¡ç‰‡
â”‚       â”‚   â”œâ”€â”€ StatusBadge.tsx       # çŠ¶æ€å¾½ç« 
â”‚       â”‚   â”œâ”€â”€ PaginationBar.tsx     # åˆ†é¡µæ¡
â”‚       â”‚   â””â”€â”€ ConfirmDialog.tsx     # ç¡®è®¤å¯¹è¯æ¡†
â”‚       â””â”€â”€ hooks/
â”‚           â”œâ”€â”€ useContent.ts         # å†…å®¹æ“ä½œ hook
â”‚           â”œâ”€â”€ useReview.ts          # å®¡æ ¸æ“ä½œ hook
â”‚           â””â”€â”€ useUsers.ts           # ç”¨æˆ·ç®¡ç† hook
â”‚
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ AuthContext.tsx               # å¤ç”¨ç°æœ‰è®¤è¯
â”‚
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ api.ts                        # å¤ç”¨ç°æœ‰ API å·¥å…·
â”‚
â””â”€â”€ hooks/
    â””â”€â”€ useAuth.ts                    # å¤ç”¨ç°æœ‰ auth hook
```

---

## ğŸ¯ åŠŸèƒ½æ¸…å•

### Phase 1: åŸºç¡€æ¡†æ¶ (1-2å¤©)

#### 1.1 åç«¯æƒé™æ£€æŸ¥å®Œæˆ âœ… (å·²å®Œæˆ)
- [x] æƒé™å‡½æ•°å·²æ·»åŠ åˆ° `backend/app/core/permissions.py`
- [x] åŒ…æ‹¬ `can_create_content`, `can_edit_content`, `can_delete_content` ç­‰

#### 1.2 å‰ç«¯è®¤è¯å±‚ (éœ€è¦)
- [ ] ç¡®ä¿ AuthContext åŒ…å« `user.role` å’Œ `user.id`
- [ ] åˆ›å»º `useAuth()` hook ç”¨äºæƒé™æ£€æŸ¥
- [ ] åˆ›å»º `ProtectedRoute` ç»„ä»¶æ£€æŸ¥è§’è‰²

#### 1.3 åŸºç¡€å¸ƒå±€ (éœ€è¦)
- [ ] AdminLayoutï¼ˆä¸»å®¹å™¨ï¼‰
- [ ] Sidebarï¼ˆå¯¼èˆªèœå•ï¼‰
- [ ] Headerï¼ˆé¡¶éƒ¨æ ï¼‰

---

### Phase 2: å†…å®¹ç®¡ç† (2-3å¤©)

#### 2.1 åˆ—è¡¨é¡µé¢
- [ ] æˆ‘çš„å†…å®¹åˆ—è¡¨ï¼ˆç”¨æˆ·åªçœ‹è‡ªå·±çš„ï¼‰
- [ ] æ‰€æœ‰å†…å®¹åˆ—è¡¨ï¼ˆç®¡ç†å‘˜çœ‹æ‰€æœ‰çš„ï¼‰
- [ ] æ”¯æŒè¿‡æ»¤ï¼ˆçŠ¶æ€ã€ç±»å‹ã€æ—¶é—´ï¼‰
- [ ] æ”¯æŒæœç´¢

#### 2.2 ç¼–è¾‘å™¨
- [ ] é€šç”¨å†…å®¹ç¼–è¾‘å™¨ï¼ˆæ–‡ç« ã€è§†é¢‘ã€å›¾ç»„ï¼‰
- [ ] è‰ç¨¿è‡ªåŠ¨ä¿å­˜
- [ ] çŠ¶æ€æ˜¾ç¤ºï¼ˆdraft/pending/approved/rejectedï¼‰
- [ ] æƒé™æ£€æŸ¥ï¼ˆè°å¯ä»¥ç¼–è¾‘ï¼‰

#### 2.3 æ“ä½œæŒ‰é’®
- [ ] ä¿å­˜ï¼ˆä¿å­˜ä¸ºè‰ç¨¿ï¼‰
- [ ] æäº¤å®¡æ ¸ï¼ˆä»è‰ç¨¿â†’pendingï¼‰
- [ ] åˆ é™¤ï¼ˆä»…å¯åˆ é™¤è‰ç¨¿ï¼‰
- [ ] å‘å¸ƒï¼ˆä»…ç®¡ç†å‘˜ï¼Œè‡ªåŠ¨ï¼‰

---

### Phase 3: å®¡æ ¸ç³»ç»Ÿ (2-3å¤©)

#### 3.1 å®¡æ ¸é¢æ¿
- [ ] å¾…å®¡æ ¸åˆ—è¡¨ï¼ˆä»…ç®¡ç†å‘˜ï¼‰
- [ ] æŒ‰å†…å®¹ç±»å‹è¿‡æ»¤
- [ ] æŒ‰æ—¶é—´æ’åº

#### 3.2 å®¡æ ¸æ“ä½œ
- [ ] æŸ¥çœ‹å†…å®¹è¯¦æƒ…
- [ ] æ‰¹å‡†æŒ‰é’®
- [ ] æ‹’ç»æŒ‰é’®ï¼ˆéœ€è¦å¡«å†™æ‹’ç»åŸå› ï¼‰
- [ ] ç¼–è¾‘å†…å®¹ï¼ˆç®¡ç†å‘˜å¯åœ¨å®¡æ ¸æ—¶ç¼–è¾‘ï¼‰

#### 3.3 æ“ä½œæ—¥å¿—
- [ ] æ˜¾ç¤ºå®¡æ ¸å†å²
- [ ] æ˜¾ç¤ºæ“ä½œäººã€æ“ä½œæ—¶é—´ã€æ“ä½œç±»å‹

---

### Phase 4: ç”¨æˆ·ç®¡ç† (1-2å¤©)

#### 4.1 ç”¨æˆ·åˆ—è¡¨ (ä»…SUPER_ADMIN)
- [ ] æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨
- [ ] ç”¨æˆ·ä¿¡æ¯ï¼ˆé‚®ç®±ã€è§’è‰²ã€çŠ¶æ€ï¼‰
- [ ] æœç´¢å’Œè¿‡æ»¤

#### 4.2 ç”¨æˆ·æ“ä½œ (ä»…SUPER_ADMIN)
- [ ] ä¿®æ”¹è§’è‰² (USER â†” ADMIN)
- [ ] ç¦ç”¨/å¯ç”¨è´¦æˆ·
- [ ] åˆ é™¤è´¦æˆ·
- [ ] é‡ç½®å¯†ç 

---

## ğŸ”§ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: React 18 + TypeScript
- **æ ·å¼**: Tailwind CSS + ç°æœ‰è®¾è®¡
- **UIç»„ä»¶**: ç°æœ‰ç»„ä»¶åº“ï¼ˆButton, Card, Modalç­‰ï¼‰
- **HTTP**: axios (ç°æœ‰ api.ts)
- **è·¯ç”±**: React Router v6

### åç«¯
- **æ¡†æ¶**: FastAPI (ç°æœ‰)
- **æ•°æ®åº“**: MySQL (ç°æœ‰)
- **è®¤è¯**: JWT (ç°æœ‰)
- **æƒé™**: `backend/app/core/permissions.py` (æ–°å¢)

---

## ğŸ“Š å¼€å‘å·¥ä½œé‡ä¼°è®¡

| é˜¶æ®µ | æ¨¡å— | å·¥ä½œé‡ | æ—¶é—´ |
|------|------|--------|------|
| 1 | è®¤è¯å±‚ + åŸºç¡€å¸ƒå±€ | 8-10h | 1å¤© |
| 2 | å†…å®¹ç®¡ç† (CRUD) | 12-16h | 2-3å¤© |
| 3 | å®¡æ ¸ç³»ç»Ÿ | 10-12h | 2å¤© |
| 4 | ç”¨æˆ·ç®¡ç† | 6-8h | 1å¤© |
| æ€»è®¡ | **å®Œæ•´åå°** | **36-46h** | **1å‘¨** |

---

## ğŸ› ï¸ å…·ä½“å®ç°æ­¥éª¤

### Step 1: ç¡®è®¤ç°æœ‰ AuthContext (2å°æ—¶)

**æ–‡ä»¶**: `frontend/src/contexts/AuthContext.tsx`

éœ€è¦ç¡®ä¿åŒ…å«ï¼š
```typescript
interface User {
  id: number;
  username: string;
  email: string;
  role: 'GUEST' | 'USER' | 'ADMIN' | 'SUPER_ADMIN';
  is_banned: boolean;
}

// æƒé™æ£€æŸ¥æ–¹æ³•
can(action: string, resource?: any): boolean
```

### Step 2: åˆ›å»º Admin App ç»“æ„ (4å°æ—¶)

**åˆ›å»ºä»¥ä¸‹æ–‡ä»¶**:

1. `frontend/src/apps/admin-v4/index.tsx` - è·¯ç”±å…¥å£
2. `frontend/src/apps/admin-v4/layout/AdminLayout.tsx` - ä¸»å¸ƒå±€
3. `frontend/src/apps/admin-v4/layout/Sidebar.tsx` - ä¾§è¾¹æ 
4. `frontend/src/apps/admin-v4/pages/Dashboard.tsx` - ä»ªè¡¨æ¿

### Step 3: å®ç°å†…å®¹ç®¡ç† (16å°æ—¶)

**åˆ†è§£ä¸º**:
- å†…å®¹åˆ—è¡¨é¡µé¢ (4h)
- ç¼–è¾‘å™¨ç»„ä»¶ (6h)
- æ“ä½œ API é›†æˆ (4h)
- æƒé™æ£€æŸ¥é›†æˆ (2h)

### Step 4: å®ç°å®¡æ ¸ç³»ç»Ÿ (10å°æ—¶)

**åˆ†è§£ä¸º**:
- å®¡æ ¸åˆ—è¡¨é¡µé¢ (3h)
- æ‰¹å‡†/æ‹’ç»åŠŸèƒ½ (4h)
- å®¡æ ¸å†å²æ˜¾ç¤º (3h)

### Step 5: å®ç°ç”¨æˆ·ç®¡ç† (6å°æ—¶)

**åˆ†è§£ä¸º**:
- ç”¨æˆ·åˆ—è¡¨é¡µé¢ (2h)
- ç”¨æˆ·æ“ä½œåŠŸèƒ½ (3h)
- æƒé™æ£€æŸ¥ (1h)

---

## ğŸ” æƒé™æ£€æŸ¥é›†æˆ

### å‰ç«¯æƒé™æ£€æŸ¥æ–¹æ¡ˆ

```typescript
// åœ¨ AuthContext ä¸­æ·»åŠ 
const can = (action: string, resource?: any): boolean => {
  // æ¸¸å®¢æ£€æŸ¥
  if (!user) return false;

  // å…·ä½“æƒé™æ£€æŸ¥
  switch (action) {
    case 'edit_content':
      return canEditContent(resource);
    case 'delete_content':
      return canDeleteContent(resource);
    case 'review':
      return user.role === 'ADMIN' || user.role === 'SUPER_ADMIN';
    case 'manage_users':
      return user.role === 'SUPER_ADMIN';
    // ...
  }
};

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
{canEditContent && <button>ç¼–è¾‘</button>}
{can('review') && <ReviewPanel />}
{can('manage_users') && <UserManagement />}
```

### åç«¯æƒé™æ£€æŸ¥æ–¹æ¡ˆ

```python
# åœ¨ API ç«¯ç‚¹ä¸­ä½¿ç”¨
@router.put("/articles/{id}")
async def update_article(
    id: int,
    article: ArticleUpdate,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
):
    item = db.query(Article).get(id)

    # æƒé™æ£€æŸ¥
    if not can_edit_content(item, current_user):
        raise HTTPException(403, "Cannot edit")

    # ç¼–è¾‘é€»è¾‘...
```

---

## ğŸ“± UI ç»„ä»¶å¤ç”¨æ¸…å•

ä»¥ä¸‹ç°æœ‰ç»„ä»¶å¯ç›´æ¥å¤ç”¨æˆ–æ”¹è¿›ï¼š

| éœ€æ±‚ | æ¨èç»„ä»¶ | ä½ç½® | æ”¹è¿›å»ºè®® |
|------|---------|------|---------|
| æŒ‰é’® | Button | shadcn/ui | âœ… ç›´æ¥ç”¨ |
| å¡ç‰‡ | Card | shadcn/ui | âœ… ç›´æ¥ç”¨ |
| è¾“å…¥æ¡† | Input | shadcn/ui | âœ… ç›´æ¥ç”¨ |
| è¡¨å• | Form | shadcn/ui | âœ… ç›´æ¥ç”¨ |
| æ¨¡æ€æ¡† | Dialog | shadcn/ui | âœ… ç›´æ¥ç”¨ |
| è¡¨æ ¼ | è‡ªå®šä¹‰ | æ–°å»º | âš ï¸ éœ€è¦æ–°å»º |
| çŠ¶æ€å¾½ç«  | Badge | shadcn/ui | âœ… æ”¹é¢œè‰² |
| åˆ†é¡µ | è‡ªå®šä¹‰ | æ–°å»º | âš ï¸ éœ€è¦æ–°å»º |
| ä¾§è¾¹æ  | ç°æœ‰å¯¼èˆª | AdminLayout | âœ… å‚è€ƒæ”¹è¿› |
| å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ | ç°æœ‰ Editor | æ£€æŸ¥ç°æœ‰ | âœ… ç›´æ¥ç”¨ |

---

## ğŸ¬ å¼€å‘èŠ‚å¥

### Week 1
- Day 1-2: Phase 1 (è®¤è¯ + åŸºç¡€å¸ƒå±€)
- Day 3-5: Phase 2 (å†…å®¹ç®¡ç†)

### Week 2
- Day 1-3: Phase 3 (å®¡æ ¸ç³»ç»Ÿ)
- Day 4-5: Phase 4 (ç”¨æˆ·ç®¡ç†) + æµ‹è¯•

---

## âœ… å®Œæˆæ ‡å‡†

åå°ç³»ç»Ÿå®Œæˆæ—¶åº”æ»¡è¶³ï¼š

- [ ] æ¸¸å®¢æ— æ³•è®¿é—®åå°
- [ ] æ™®é€šç”¨æˆ·å¯ä»¥åˆ›å»º/ç¼–è¾‘è‡ªå·±çš„å†…å®¹
- [ ] ç®¡ç†å‘˜å¯ä»¥å®¡æ ¸å’Œç¼–è¾‘ä»»ä½•å†…å®¹
- [ ] è¶…ç®¡å¯ä»¥ç®¡ç†ç”¨æˆ·
- [ ] æ‰€æœ‰æ“ä½œéƒ½æœ‰æƒé™æ£€æŸ¥
- [ ] æ‰€æœ‰æ“ä½œéƒ½è®°å½•æ—¥å¿—
- [ ] UI ç¾è§‚ä¸”æ˜“ç”¨
- [ ] ç§»åŠ¨ç«¯å“åº”å¼

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- **æƒé™ç³»ç»Ÿ**: [PERMISSION_IMPLEMENTATION_PLAN.md](./PERMISSION_IMPLEMENTATION_PLAN.md)
- **æƒé™å‡½æ•°**: `backend/app/core/permissions.py` (å·²å®ç°)
- **ç°æœ‰ API**: `backend/app/routers/` (å‚è€ƒ)

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. **ç¡®è®¤æ¶æ„** - åŒæ„è¿™ä¸ªç»“æ„ï¼Ÿ
2. **ç¡®è®¤ UI å¤ç”¨** - éœ€è¦æ”¹åŠ¨å“ªäº›ç°æœ‰ç»„ä»¶ï¼Ÿ
3. **å¼€å§‹ Phase 1** - è®¤è¯å±‚å’ŒåŸºç¡€å¸ƒå±€

---

**çŠ¶æ€**: ğŸ“‹ è®¡åˆ’å·²åˆ¶å®šï¼Œç­‰å¾…å®¡æ‰¹å’Œå¼€å‘
