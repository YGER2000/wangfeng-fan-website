# æ±ªå³°ç²‰ä¸ç½‘ç«™ - è¡Œç¨‹ä¿¡æ¯å®ç°æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [å½“å‰å®ç°åˆ†æ](#å½“å‰å®ç°åˆ†æ)
3. [æ•°æ®å­˜å‚¨æ¶æ„](#æ•°æ®å­˜å‚¨æ¶æ„)
4. [åŠŸèƒ½æ¨¡å—](#åŠŸèƒ½æ¨¡å—)
5. [API æ¥å£](#api-æ¥å£)
6. [å›¾ç‰‡å­˜å‚¨æ–¹æ¡ˆ](#å›¾ç‰‡å­˜å‚¨æ–¹æ¡ˆ)
7. [å‰ç«¯å®ç°](#å‰ç«¯å®ç°)
8. [è¡Œç¨‹ä¸æ–‡ç« å…³è”](#è¡Œç¨‹ä¸æ–‡ç« å…³è”)
9. [åç»­è§„åˆ’](#åç»­è§„åˆ’)

---

## ç³»ç»Ÿæ¦‚è¿°

è¡Œç¨‹ä¿¡æ¯ç®¡ç†ç³»ç»Ÿç”¨äºç®¡ç†æ±ªå³°çš„æ¼”å‡ºè¡Œç¨‹ï¼ŒåŒ…æ‹¬æ¼”å”±ä¼šã€éŸ³ä¹èŠ‚ã€å•†æ¼”ã€ç»¼è‰ºæ´»åŠ¨ç­‰ã€‚ç³»ç»Ÿé‡‡ç”¨ **MySQL æ•°æ®åº“** ä½œä¸ºå”¯ä¸€æ•°æ®æºï¼Œæ‰€æœ‰è¡Œç¨‹æ•°æ®å‡å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œä¸ä½¿ç”¨ä»»ä½•æœ¬åœ° JSON æ–‡ä»¶ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… çº¯ MySQL æ•°æ®åº“å­˜å‚¨
- âœ… æ”¯æŒå›¾ç‰‡ä¸Šä¼ å’Œå‹ç¼©
- âœ… å®¡æ ¸å‘å¸ƒæµç¨‹
- âœ… å¤šç§è¡Œç¨‹åˆ†ç±»
- âœ… æ ‡ç­¾ç³»ç»Ÿæ”¯æŒ
- âœ… å›¾ç‰‡è‡ªåŠ¨å‹ç¼©ï¼ˆç¼©ç•¥å›¾ï¼‰
- âœ… è¡Œç¨‹å¡ç‰‡å±•ç¤º + æ–‡ç« è¯¦æƒ…é¡µ
- âœ… è‡ªåŠ¨ç”Ÿæˆè¡Œç¨‹ä¿¡æ¯æ–‡ç« 

---

## å½“å‰å®ç°åˆ†æ

### 1. æ•°æ®å­˜å‚¨ç°çŠ¶

#### âœ… å·²å®ç°ï¼šMySQL å­˜å‚¨
- **æ•°æ®åº“è¡¨**: `schedules`
- **æœåŠ¡ç±»**: `ScheduleServiceMySQL`
- **è·¯ç”±**: `/api/schedules`

### 2. å½“å‰åŠŸèƒ½å®ç°

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| è¡Œç¨‹åˆ›å»º | âœ… å·²å®ç° | ç”¨æˆ·æäº¤åå¾…å®¡æ ¸ |
| è¡Œç¨‹åˆ—è¡¨ | âœ… å·²å®ç° | ä»…æ˜¾ç¤ºå·²å‘å¸ƒçš„è¡Œç¨‹ |
| è¡Œç¨‹å®¡æ ¸ | âœ… å·²å®ç° | ç®¡ç†å‘˜å®¡æ ¸å‘å¸ƒ |
| å›¾ç‰‡ä¸Šä¼  | âœ… å·²å®ç° | æ”¯æŒåŸå›¾å’Œç¼©ç•¥å›¾ |
| å›¾ç‰‡å‹ç¼© | âœ… å·²å®ç° | è‡ªåŠ¨ç”Ÿæˆ 200KB ä»¥ä¸‹ç¼©ç•¥å›¾ |
| è¡Œç¨‹æ›´æ–° | âœ… å·²å®ç° | æ”¯æŒä¿®æ”¹è¡Œç¨‹ä¿¡æ¯ |
| è¡Œç¨‹åˆ é™¤ | âœ… å·²å®ç° | ç‰©ç†åˆ é™¤ |
| å¡ç‰‡å±•ç¤º | âœ… å·²å®ç° | å‰ç«¯ä»¥å¡ç‰‡å½¢å¼å±•ç¤º |
| æ–‡ç« è¯¦æƒ…é¡µ | âœ… å·²å®ç° | è‡ªåŠ¨ç”Ÿæˆè¡Œç¨‹ä¿¡æ¯æ–‡ç«  |
| æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® | âœ… å·²å®ç° | å¡ç‰‡å¼¹çª—ä¸­è·³è½¬åˆ°æ–‡ç«  |

---

## æ•°æ®å­˜å‚¨æ¶æ„

### MySQL æ•°æ®åº“è¡¨ç»“æ„

**è¡¨å**: `schedules`

| å­—æ®µå | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|--------|------|------|------|
| id | INTEGER | PRIMARY KEY, AUTO_INCREMENT | è¡Œç¨‹å”¯ä¸€æ ‡è¯† |
| category | VARCHAR(20) | NOT NULL, INDEX | è¡Œç¨‹åˆ†ç±»ï¼ˆæ¼”å”±ä¼š/livehouse/éŸ³ä¹èŠ‚/å•†æ¼”æ‹¼ç›˜/ç»¼è‰ºæ™šä¼š/ç›´æ’­/å•†ä¸šæ´»åŠ¨/å…¶ä»–ï¼‰ |
| date | VARCHAR(10) | NOT NULL, INDEX | è¡Œç¨‹æ—¥æœŸ YYYY-MM-DD |
| city | VARCHAR(50) | NOT NULL | åŸå¸‚ |
| venue | VARCHAR(200) | NULLABLE | å…·ä½“åœºé¦†/åœ°ç‚¹ |
| theme | VARCHAR(200) | NOT NULL | è¡Œç¨‹ä¸»é¢˜/è¯¦æƒ… |
| description | TEXT | NULLABLE | è¡¥å……è¯´æ˜ |
| image | VARCHAR(500) | NULLABLE | æµ·æŠ¥å›¾ç‰‡è·¯å¾„ï¼ˆåŸå›¾ï¼‰ |
| image_thumb | VARCHAR(500) | NULLABLE | æµ·æŠ¥ç¼©ç•¥å›¾è·¯å¾„ï¼ˆå‹ç¼©å›¾ï¼‰ |
| tags | TEXT | NULLABLE | æ ‡ç­¾ï¼Œç”¨é€—å·åˆ†éš” |
| source | VARCHAR(20) | NOT NULL, DEFAULT='custom' | æ•°æ®æ¥æºï¼šlegacy/custom |
| review_status | VARCHAR(20) | NOT NULL, DEFAULT='pending', INDEX | å®¡æ ¸çŠ¶æ€: pending/approved |
| is_published | INTEGER | NOT NULL, DEFAULT=0 | æ˜¯å¦å·²å‘å¸ƒ: 0æœªå‘å¸ƒ/1å·²å‘å¸ƒ |
| **article_id** | VARCHAR(36) | NULLABLE, INDEX | **å…³è”çš„æ–‡ç« ID** |
| created_at | DATETIME | NOT NULL, DEFAULT=CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | DATETIME | NOT NULL, ON UPDATE | æ›´æ–°æ—¶é—´ |

### SQLAlchemy æ¨¡å‹

**æ–‡ä»¶**: `backend/app/models/schedule_db.py`

```python
class Schedule(Base):
    __tablename__ = "schedules"

    id = Column(Integer, primary_key=True, index=True, autoincrement=True)
    category = Column(String(20), nullable=False, index=True)
    date = Column(String(10), nullable=False, index=True)
    city = Column(String(50), nullable=False)
    venue = Column(String(200), nullable=True)
    theme = Column(String(200), nullable=False)
    description = Column(Text, nullable=True)
    image = Column(String(500), nullable=True)
    image_thumb = Column(String(500), nullable=True)
    tags = Column(Text, nullable=True)
    source = Column(String(20), default='custom', nullable=False)
    review_status = Column(String(20), default='pending', nullable=False, index=True)
    is_published = Column(Integer, default=0, nullable=False)
    article_id = Column(String(36), nullable=True, index=True)  # æ–°å¢å­—æ®µ
    created_at = Column(DateTime, default=datetime.utcnow, nullable=False)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
```

### è¡Œç¨‹åˆ†ç±»

è¡Œç¨‹åˆ†ç±»åœ¨å‰ç«¯å’Œåç«¯æœ‰ä¸åŒçš„å®ç°æ–¹å¼ï¼š

**åç«¯ Schema** (`backend/app/schemas/schedule.py`):
```python
class ScheduleCategory(str, Enum):
    concert = 'æ¼”å”±ä¼š'      # ä¸ªäººæ¼”å”±ä¼š
    festival = 'éŸ³ä¹èŠ‚'     # éŸ³ä¹èŠ‚æ¼”å‡º
    commercial = 'å•†æ¼”'     # å•†ä¸šæ¼”å‡º
    variety = 'ç»¼è‰ºæ´»åŠ¨'    # ç»¼è‰ºæ™šä¼š
    other = 'å…¶ä»–'          # å…¶ä»–æ´»åŠ¨
```

**æ•°æ®åº“æ¨¡å‹** (`backend/app/models/schedule_db.py`):
- `category` å­—æ®µç±»å‹ä¸º `String(20)`ï¼Œä¸ä½¿ç”¨æšä¸¾çº¦æŸ
- å…è®¸å­˜å‚¨ä»»æ„å­—ç¬¦ä¸²ç±»å‹çš„åˆ†ç±»åç§°

**å‰ç«¯ç±»å‹å®šä¹‰** (`frontend/src/utils/api.ts`):
```typescript
export type ScheduleCategory =
  | 'æ¼”å”±ä¼š'      // ä¸ªäººæ¼”å”±ä¼š
  | 'livehouse'   // Livehouseæ¼”å‡º
  | 'éŸ³ä¹èŠ‚'      // éŸ³ä¹èŠ‚æ¼”å‡º
  | 'å•†æ¼”æ‹¼ç›˜'    // å•†æ¼”æ‹¼ç›˜
  | 'ç»¼è‰ºæ™šä¼š'    // ç»¼è‰ºæ™šä¼šæ´»åŠ¨
  | 'ç›´æ’­'        // ç›´æ’­æ´»åŠ¨
  | 'å•†ä¸šæ´»åŠ¨'    // å•†ä¸šæ´»åŠ¨
  | 'å…¶ä»–';       // å…¶ä»–ç±»å‹æ´»åŠ¨
```

**å‰ç«¯æ˜¾ç¤º** (`frontend/src/components/pages/TourDates.tsx`):
```typescript
const categories: Array<'å…¨éƒ¨' | ScheduleCategory> = [
  'å…¨éƒ¨',
  'æ¼”å”±ä¼š',
  'livehouse',
  'éŸ³ä¹èŠ‚',
  'å•†æ¼”æ‹¼ç›˜',
  'ç»¼è‰ºæ™šä¼š',
  'ç›´æ’­',
  'å•†ä¸šæ´»åŠ¨',
  'å…¶ä»–',
];
```

**è¯´æ˜**:
- åç«¯ Schema ä¸­çš„æšä¸¾ä¸»è¦ç”¨äº API æ–‡æ¡£å’ŒåŸºæœ¬éªŒè¯
- æ•°æ®åº“ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹ï¼Œä¸å¼ºåˆ¶æšä¸¾çº¦æŸï¼Œæä¾›æ›´å¤§çš„çµæ´»æ€§
- å‰ç«¯å®šä¹‰äº†æ›´è¯¦ç»†çš„8ç§åˆ†ç±»ï¼Œç”¨äºç²¾ç¡®çš„è¡Œç¨‹åˆ†ç±»å’Œç­›é€‰
- ä¸¤è€…ä¹‹é—´çš„å·®å¼‚æ˜¯ä¸ºäº†ä¿æŒç³»ç»Ÿçš„çµæ´»æ€§ï¼ŒåŒæ—¶æ»¡è¶³å‰ç«¯å±•ç¤ºéœ€æ±‚

---

## åŠŸèƒ½æ¨¡å—

### 1. è¡Œç¨‹åˆ›å»ºæµç¨‹

```mermaid
sequenceDiagram
    participant ç”¨æˆ·
    participant å‰ç«¯
    participant åç«¯API
    participant MySQL
    participant æ–‡ä»¶ç³»ç»Ÿ

    ç”¨æˆ·->>å‰ç«¯: å¡«å†™è¡Œç¨‹ä¿¡æ¯
    ç”¨æˆ·->>å‰ç«¯: ä¸Šä¼ æµ·æŠ¥å›¾ç‰‡
    å‰ç«¯->>åç«¯API: POST /api/schedules
    åç«¯API->>æ–‡ä»¶ç³»ç»Ÿ: ä¿å­˜å›¾ç‰‡åˆ° temp/ æ–‡ä»¶å¤¹
    åç«¯API->>MySQL: åˆ›å»ºè¡Œç¨‹è®°å½•ï¼ˆå¾…å®¡æ ¸ï¼‰
    MySQL-->>åç«¯API: è¿”å›è¡Œç¨‹æ•°æ®
    åç«¯API-->>å‰ç«¯: è¿”å›åˆ›å»ºç»“æœ
    å‰ç«¯-->>ç”¨æˆ·: æç¤ºæäº¤æˆåŠŸï¼Œç­‰å¾…å®¡æ ¸
```

### 2. è¡Œç¨‹å®¡æ ¸å‘å¸ƒæµç¨‹ï¼ˆå«æ–‡ç« åˆ›å»ºï¼‰

```mermaid
sequenceDiagram
    participant ç®¡ç†å‘˜
    participant å‰ç«¯
    participant åç«¯API
    participant MySQL Articles
    participant MySQL Schedules
    participant æ–‡ä»¶ç³»ç»Ÿ

    ç®¡ç†å‘˜->>å‰ç«¯: æŸ¥çœ‹å¾…å®¡æ ¸è¡Œç¨‹
    ç®¡ç†å‘˜->>å‰ç«¯: ç‚¹å‡»å‘å¸ƒ

    å‰ç«¯->>åç«¯API: POST /api/schedules/{id}/publish
    åç«¯API->>æ–‡ä»¶ç³»ç»Ÿ: å°†å›¾ç‰‡ä» temp/ ç§»åŠ¨åˆ°æ­£å¼æ–‡ä»¶å¤¹
    åç«¯API->>æ–‡ä»¶ç³»ç»Ÿ: ç”Ÿæˆå‹ç¼©ç¼©ç•¥å›¾

    Note over åç«¯API: è‡ªåŠ¨åˆ›å»ºè¡Œç¨‹æ–‡ç« 
    åç«¯API->>åç«¯API: ç”Ÿæˆæ–‡ç« å†…å®¹ï¼ˆMarkdownï¼‰
    åç«¯API->>åç«¯API: ç”Ÿæˆ slug
    åç«¯API->>MySQL Articles: åˆ›å»ºæ–‡ç« è®°å½•
    MySQL Articles-->>åç«¯API: è¿”å› article_id

    åç«¯API->>MySQL Schedules: æ›´æ–° is_published=1, article_id
    MySQL Schedules-->>åç«¯API: è¿”å›æ›´æ–°ç»“æœ

    åç«¯API-->>å‰ç«¯: è¿”å›å‘å¸ƒæˆåŠŸ
    å‰ç«¯-->>ç®¡ç†å‘˜: æç¤ºå‘å¸ƒæˆåŠŸ
```

### 3. å‰å°å±•ç¤ºæµç¨‹

```mermaid
sequenceDiagram
    participant è®¿å®¢
    participant å‰ç«¯
    participant åç«¯API
    participant MySQL

    è®¿å®¢->>å‰ç«¯: è®¿é—®è¡Œç¨‹é¡µé¢
    å‰ç«¯->>åç«¯API: GET /api/schedules
    åç«¯API->>MySQL: æŸ¥è¯¢ is_published=1 çš„è¡Œç¨‹
    MySQL-->>åç«¯API: è¿”å›å·²å‘å¸ƒè¡Œç¨‹
    åç«¯API-->>å‰ç«¯: è¿”å›è¡Œç¨‹åˆ—è¡¨ï¼ˆå« article_idï¼‰
    å‰ç«¯->>å‰ç«¯: æ¸²æŸ“å¡ç‰‡åˆ—è¡¨

    è®¿å®¢->>å‰ç«¯: ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
    å‰ç«¯->>å‰ç«¯: æ˜¾ç¤ºå¼¹çª—ï¼ˆæµ·æŠ¥ + åŸºæœ¬ä¿¡æ¯ï¼‰

    è®¿å®¢->>å‰ç«¯: ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®
    å‰ç«¯->>å‰ç«¯: æ ¹æ® article_id æˆ– slug è·³è½¬åˆ°æ–‡ç« é¡µ
    å‰ç«¯->>åç«¯API: GET /api/articles/{slug}
    åç«¯API-->>å‰ç«¯: è¿”å›æ–‡ç« è¯¦æƒ…
    å‰ç«¯-->>è®¿å®¢: æ˜¾ç¤ºå®Œæ•´æ–‡ç« é¡µé¢
```

---

## API æ¥å£

### 1. è·å–è¡Œç¨‹åˆ—è¡¨

**ç«¯ç‚¹**: `GET /api/schedules`

**è¯´æ˜**: è·å–æ‰€æœ‰å·²å‘å¸ƒçš„è¡Œç¨‹ï¼ˆå‰å°å±•ç¤ºï¼‰

**å“åº”**:
```json
[
  {
    "id": 1,
    "category": "æ¼”å”±ä¼š",
    "date": "2025-12-27",
    "city": "é•¿æ²™",
    "venue": "è´ºé¾™ä½“è‚²é¦†",
    "theme": "æ±ªå³°"ç›¸ä¿¡æœªæ¥"å·¡å›æ¼”å”±ä¼šé•¿æ²™ç«™",
    "description": "é—¨ç¥¨å³å°†å¼€å”®",
    "image": "images/æ¼”å”±ä¼š/2025.12.27-ç›¸ä¿¡æœªæ¥é•¿æ²™ç«™/æµ·æŠ¥.jpg",
    "image_thumb": "images/æ¼”å”±ä¼š/2025.12.27-ç›¸ä¿¡æœªæ¥é•¿æ²™ç«™/æµ·æŠ¥-thumb.jpg",
    "tags": ["æ¼”å”±ä¼š", "ç›¸ä¿¡æœªæ¥"],
    "article_id": "abc123-def456-ghi789",
    "source": "custom",
    "is_published": 1
  },
  {
    "id": 2,
    "category": "livehouse",
    "date": "2025-11-15",
    "city": "åŒ—äº¬",
    "venue": "MAO Livehouse",
    "theme": "æ±ªå³° Livehouse å°å‹æ¼”å‡º",
    "description": "é™å®š100äºº",
    "image": "images/livehouse/2025.11.15-åŒ—äº¬ç«™/æµ·æŠ¥.jpg",
    "image_thumb": "images/livehouse/2025.11.15-åŒ—äº¬ç«™/æµ·æŠ¥-thumb.jpg",
    "tags": ["livehouse", "åŒ—äº¬"],
    "article_id": "def456-ghi789-jkl012",
    "source": "custom",
    "is_published": 1
  }
]
```

---

## å›¾ç‰‡å­˜å‚¨æ–¹æ¡ˆ

### å›¾ç‰‡å­˜å‚¨è·¯å¾„ç»“æ„

```
frontend/public/images/
â”œâ”€â”€ temp/                                    # ä¸´æ—¶æ–‡ä»¶å¤¹ï¼ˆå¾…å®¡æ ¸ï¼‰
â”‚   â””â”€â”€ 2025.12.27-ç›¸ä¿¡æœªæ¥é•¿æ²™ç«™-æµ·æŠ¥.jpg
â”œâ”€â”€ æ¼”å”±ä¼š/
â”‚   â”œâ”€â”€ 2025.12.27-ç›¸ä¿¡æœªæ¥é•¿æ²™ç«™/
â”‚   â”‚   â”œâ”€â”€ 2025.12.27-ç›¸ä¿¡æœªæ¥é•¿æ²™ç«™-æµ·æŠ¥.jpg         # åŸå›¾
â”‚   â”‚   â””â”€â”€ 2025.12.27-ç›¸ä¿¡æœªæ¥é•¿æ²™ç«™-æµ·æŠ¥-thumb.jpg   # ç¼©ç•¥å›¾
â”‚   â””â”€â”€ 2025.12.30-ç›¸ä¿¡æœªæ¥åŒ—äº¬ç«™/
â”‚       â”œâ”€â”€ 2025.12.30-ç›¸ä¿¡æœªæ¥åŒ—äº¬ç«™-æµ·æŠ¥.jpg
â”‚       â””â”€â”€ 2025.12.30-ç›¸ä¿¡æœªæ¥åŒ—äº¬ç«™-æµ·æŠ¥-thumb.jpg
â”œâ”€â”€ éŸ³ä¹èŠ‚/
â”‚   â””â”€â”€ 2025.11.15-è‰è“éŸ³ä¹èŠ‚/
â”‚       â”œâ”€â”€ 2025.11.15-è‰è“éŸ³ä¹èŠ‚-æµ·æŠ¥.jpg
â”‚       â””â”€â”€ 2025.11.15-è‰è“éŸ³ä¹èŠ‚-æµ·æŠ¥-thumb.jpg
â””â”€â”€ é»˜è®¤æµ·æŠ¥.jpg                             # é»˜è®¤æµ·æŠ¥
```

---

## å‰ç«¯å®ç°

### 1. è¡Œç¨‹å¡ç‰‡å±•ç¤º

**ç»„ä»¶**: `frontend/src/components/pages/TourDates.tsx`

**åŠŸèƒ½**:
- æ˜¾ç¤ºæ‰€æœ‰å·²å‘å¸ƒçš„è¡Œç¨‹ï¼ˆ`is_published=1`ï¼‰
- å¡ç‰‡å¼å¸ƒå±€
- æ˜¾ç¤ºæ—¥æœŸã€åŸå¸‚ã€ä¸»é¢˜ã€æµ·æŠ¥ç¼©ç•¥å›¾
- ç‚¹å‡»å¡ç‰‡å¼¹å‡ºè¯¦æƒ…å¼¹çª—

### 2. è¡Œç¨‹è¯¦æƒ…å¼¹çª—

**åŠŸèƒ½**:
- æ˜¾ç¤ºæµ·æŠ¥å¤§å›¾
- æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯ï¼ˆæ—¥æœŸã€åŸå¸‚ã€åœºé¦†ã€åˆ†ç±»ï¼‰
- æ˜¾ç¤ºè¡¥å……è¯´æ˜
- **ä¸¤ä¸ªæŒ‰é’®**ï¼š
  - **æŸ¥çœ‹è¯¦æƒ…** - è·³è½¬åˆ°è¡Œç¨‹ä¿¡æ¯æ–‡ç« é¡µ
  - **å…³é—­** - å…³é—­å¼¹çª—

**å®ç°ä»£ç **:
```tsx
<div className="absolute right-4 top-4 flex gap-2">
  <button
    onClick={() => {
      // è·³è½¬åˆ°æ–‡ç« è¯¦æƒ…é¡µ
      const dateStr = selectedSchedule.date.replace(/-/g, '');
      const theme = selectedSchedule.theme.substring(0, 20);
      const slug = `${dateStr}-${theme}`;
      window.location.href = `/#/articles/${slug}`;
    }}
    className="px-4 py-2 rounded-lg bg-wangfeng-purple hover:bg-wangfeng-dark transition-colors text-white text-sm font-medium"
  >
    æŸ¥çœ‹è¯¦æƒ…
  </button>
  <button
    onClick={() => setSelectedSchedule(null)}
    className="p-2 rounded-lg transition-colors hover:bg-white/10"
  >
    <X className="h-6 w-6 theme-text-primary" />
  </button>
</div>
```

---

## è¡Œç¨‹ä¸æ–‡ç« å…³è”

### 1. è®¾è®¡ç†å¿µ

**ä¸ºæ¯ä¸ªè¡Œç¨‹è‡ªåŠ¨åˆ›å»ºä¸€ç¯‡æ–‡ç« **ï¼š
- æ–‡ç« å½’ç±»åœ¨ `èµ„æ–™ç§‘æ™® > è¡Œç¨‹ä¿¡æ¯`
- æ–‡ç« æ ‡é¢˜ = è¡Œç¨‹ä¸»é¢˜
- æ–‡ç« å†…å®¹ä½¿ç”¨é¢„è®¾æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆ
- åç»­å¯åœ¨åå°ç®¡ç†ä¸­ç¼–è¾‘æ–‡ç« å†…å®¹

### 2. æ–‡ç« æ¨¡æ¿ç»“æ„

**æ¨¡æ¿ç»„æˆ**:
1. **åŸºæœ¬ä¿¡æ¯**ï¼šæ—¶é—´ã€åŸå¸‚ã€åœºé¦†ã€åˆ†ç±»
2. **æ¼”å‡ºæµ·æŠ¥**ï¼šè¡Œç¨‹å›¾ç‰‡ï¼ˆå“åº”å¼å±•ç¤ºï¼‰
3. **è¡¥å……è¯´æ˜**ï¼šè¡Œç¨‹æè¿°
4. **è´­ç¥¨ä¿¡æ¯**ï¼šé¢„ç•™åŒºåŸŸï¼ˆåç»­ç¼–è¾‘ï¼‰
5. **äº¤é€šæŒ‡å—**ï¼šé¢„ç•™åŒºåŸŸï¼ˆåç»­ç¼–è¾‘ï¼‰

**ç¤ºä¾‹æ–‡ç« å†…å®¹**ï¼ˆMarkdownæ ¼å¼ï¼‰:

```markdown
## ğŸ“… æ¼”å‡ºä¿¡æ¯

**æ—¶é—´**: 2025-12-27
**åŸå¸‚**: é•¿æ²™
**åœºé¦†**: è´ºé¾™ä½“è‚²é¦†
**åˆ†ç±»**: æ¼”å”±ä¼š

---

## ğŸ¤ æ¼”å‡ºæµ·æŠ¥

<img src="/images/æ¼”å”±ä¼š/2025.12.27-ç›¸ä¿¡æœªæ¥é•¿æ²™ç«™/æµ·æŠ¥.jpg" alt="æ±ªå³°"ç›¸ä¿¡æœªæ¥"å·¡å›æ¼”å”±ä¼šé•¿æ²™ç«™" style="max-width: 100%; height: auto; border-radius: 8px;" />

## ğŸ“ è¡¥å……è¯´æ˜

é—¨ç¥¨å³å°†å¼€å”®ï¼Œæ•¬è¯·æœŸå¾…ï¼

## ğŸ« è´­ç¥¨ä¿¡æ¯

> è´­ç¥¨ä¿¡æ¯å°†åœ¨å”®ç¥¨å¼€å¯åæ›´æ–°ï¼Œè¯·å…³æ³¨æ±ªå³°å®˜æ–¹å¾®åšåŠå„å¤§ç¥¨åŠ¡å¹³å°ã€‚

## ğŸš— äº¤é€šæŒ‡å—

> äº¤é€šæŒ‡å—å°†åœ¨æ¼”å‡ºä¸´è¿‘æ—¶æ›´æ–°ï¼Œæ•¬è¯·æœŸå¾…ã€‚

---

*æœ¬æ–‡ç« ç”±ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œå†…å®¹å¯èƒ½ä¸å®Œæ•´ã€‚å¦‚æœ‰æœ€æ–°æ¶ˆæ¯ï¼Œè¯·ä»¥å®˜æ–¹å‘å¸ƒä¸ºå‡†ã€‚*
```

### 3. æ–‡ç« å±æ€§

| å±æ€§ | å€¼ | è¯´æ˜ |
|------|-----|------|
| **category_primary** | èµ„æ–™ç§‘æ™® | ä¸€çº§åˆ†ç±» |
| **category_secondary** | è¡Œç¨‹ä¿¡æ¯ | äºŒçº§åˆ†ç±» |
| **author** | æ±ªå³°å®˜æ–¹ | ä½œè€… |
| **is_published** | true | é»˜è®¤å‘å¸ƒ |
| **review_status** | approved | é»˜è®¤å·²å®¡æ ¸ |
| **tags** | [æ¼”å”±ä¼š, é•¿æ²™, æ¼”å‡ºä¿¡æ¯] | è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾ |

### 4. Slug ç”Ÿæˆè§„åˆ™

**æ ¼å¼**: `æ—¥æœŸ-ä¸»é¢˜å‰20å­—`

**ç¤ºä¾‹**:
- è¡Œç¨‹ä¸»é¢˜ï¼š`æ±ªå³°"ç›¸ä¿¡æœªæ¥"å·¡å›æ¼”å”±ä¼šé•¿æ²™ç«™`
- æ—¥æœŸï¼š`2025-12-27`
- ç”Ÿæˆçš„ slugï¼š`20251227-æ±ªå³°ç›¸ä¿¡æœªæ¥å·¡å›æ¼”å”±ä¼šé•¿æ²™ç«™`

### 5. åˆ›å»ºæ–‡ç« ç¤ºä¾‹è„šæœ¬

**æ–‡ä»¶**: `backend/create_schedule_article_template.py`

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd backend
python3 create_schedule_article_template.py
```

**åŠŸèƒ½**:
- è¯»å–æŒ‡å®šè¡Œç¨‹IDçš„æ•°æ®
- æ ¹æ®æ¨¡æ¿ç”Ÿæˆæ–‡ç« å†…å®¹
- åˆ›å»ºæ–‡ç« è®°å½•å¹¶å­˜å…¥ MySQL
- è¾“å‡ºè®¿é—®é“¾æ¥

---

## åç»­è§„åˆ’

### é˜¶æ®µä¸€ï¼šè‡ªåŠ¨åŒ–è¡Œç¨‹æ–‡ç« åˆ›å»ºï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**: å‘å¸ƒè¡Œç¨‹æ—¶è‡ªåŠ¨åˆ›å»ºæ–‡ç« 

**å®ç°æ­¥éª¤**:

1. **ä¿®æ”¹å‘å¸ƒæ¥å£**ï¼ˆ`backend/app/routers/schedules.py`ï¼‰
   ```python
   @router.post("/{schedule_id}/publish")
   async def publish_schedule(schedule_id: int):
       # 1. å‘å¸ƒè¡Œç¨‹
       schedule = schedule_service.publish_schedule(schedule_id)
   
       # 2. è‡ªåŠ¨åˆ›å»ºæ–‡ç« 
       article = create_schedule_article(schedule)
   
       # 3. æ›´æ–°è¡Œç¨‹çš„ article_id
       schedule_service.update_entry(schedule_id, article_id=article.id)
   
       return {"schedule": schedule, "article": article}
   ```

2. **æå–æ–‡ç« ç”Ÿæˆé€»è¾‘ä¸ºç‹¬ç«‹å‡½æ•°**
   - ä½ç½®ï¼š`backend/app/services/schedule_article_service.py`
   - å‡½æ•°ï¼š`generate_schedule_article(schedule) -> Article`

3. **æµ‹è¯•æµç¨‹**:
   - åˆ›å»ºæ–°è¡Œç¨‹
   - å‘å¸ƒè¡Œç¨‹
   - éªŒè¯æ–‡ç« æ˜¯å¦è‡ªåŠ¨åˆ›å»º
   - éªŒè¯ article_id æ˜¯å¦æ­£ç¡®å…³è”

### é˜¶æ®µäºŒï¼šæ‰¹é‡ä¸ºç°æœ‰è¡Œç¨‹è¡¥å……æ–‡ç« ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**: ä¸º100æ¡ç°æœ‰è¡Œç¨‹æ‰¹é‡åˆ›å»ºæ–‡ç« 

**å®ç°è„šæœ¬**: `backend/batch_create_schedule_articles.py`

**æ­¥éª¤**:
```python
def batch_create_articles():
    schedules = db.query(Schedule).filter(
        Schedule.is_published == 1,
        Schedule.article_id.is_(None)
    ).all()

    for schedule in schedules:
        article = create_schedule_article(schedule)
        schedule.article_id = article.id
        db.commit()
```

### é˜¶æ®µä¸‰ï¼šå¯Œæ–‡æœ¬ç¼–è¾‘å™¨é›†æˆï¼ˆä½ä¼˜å…ˆçº§ï¼‰

**ç›®æ ‡**: åå°ç®¡ç†æ”¯æŒç¼–è¾‘æ–‡ç« å†…å®¹

**æŠ€æœ¯é€‰å‹**:
- æ¨èï¼š`@mdxeditor/editor` ï¼ˆMarkdownç¼–è¾‘å™¨ï¼‰
- å¤‡é€‰ï¼š`react-quill` ï¼ˆå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼‰

**åŠŸèƒ½**:
- ç¼–è¾‘è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ç« å†…å®¹
- æ·»åŠ æ›´å¤šæ¼”å‡ºä¿¡æ¯
- æ’å…¥å›¾ç‰‡
- æ ¼å¼åŒ–æ–‡æœ¬

---

## æ€»ç»“

### å½“å‰çŠ¶æ€

âœ… **å·²å®Œæˆ**:
- æ‰€æœ‰è¡Œç¨‹æ•°æ®å­˜å‚¨åœ¨ MySQL æ•°æ®åº“ä¸­
- ä¸ä½¿ç”¨ä»»ä½•æœ¬åœ° JSON æ–‡ä»¶
- å›¾ç‰‡ä¸Šä¼ å’Œå‹ç¼©åŠŸèƒ½å®Œå–„
- å®¡æ ¸å‘å¸ƒæµç¨‹å®Œæ•´
- å‰ç«¯å¡ç‰‡å±•ç¤ºåŠŸèƒ½æ­£å¸¸
- è¡Œç¨‹å¡ç‰‡å¼¹çª—æ”¯æŒ"æŸ¥çœ‹è¯¦æƒ…"å’Œ"å…³é—­"ä¸¤ä¸ªæŒ‰é’®
- æ–‡ç« æ¨¡æ¿å·²åˆ›å»ºï¼Œå¯æ‰‹åŠ¨ç”Ÿæˆè¡Œç¨‹ä¿¡æ¯æ–‡ç« 
- schedules è¡¨å·²æ·»åŠ  article_id å­—æ®µ

### å·²åºŸå¼ƒå†…å®¹

âŒ **ä¸å†ä½¿ç”¨**:
- `backend/data/schedule_entries.json` - æœ¬åœ° JSON å­˜å‚¨ï¼ˆå·²åˆ é™¤ï¼‰
- `backend/app/services/schedule_service.py` - æ—§çš„æœåŠ¡ç±»ï¼ˆå·²åˆ é™¤ï¼‰

### åç»­å·¥ä½œ

ğŸ“‹ **å¾…å®ç°**:
1. **é«˜ä¼˜å…ˆçº§**: å‘å¸ƒè¡Œç¨‹æ—¶è‡ªåŠ¨åˆ›å»ºæ–‡ç« 
2. **ä¸­ä¼˜å…ˆçº§**: æ‰¹é‡ä¸ºç°æœ‰100æ¡è¡Œç¨‹è¡¥å……æ–‡ç« 
3. **ä½ä¼˜å…ˆçº§**: å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ”¯æŒç¼–è¾‘æ–‡ç« å†…å®¹

### ç¤ºä¾‹æ–‡ç« 

ä½ å¯ä»¥è®¿é—®ä»¥ä¸‹é“¾æ¥æŸ¥çœ‹åˆ›å»ºçš„ç¤ºä¾‹æ–‡ç« ï¼š

```
http://localhost:1997/#/articles/20251227-æ±ªå³°ç›¸ä¿¡æœªæ¥å·¡å›æ¼”å”±ä¼šé•¿æ²™ç«™
```

æˆ–åœ¨å‰ç«¯çš„ **èµ„æ–™ç§‘æ™® > è¡Œç¨‹ä¿¡æ¯** åˆ†ç±»ä¸‹æŸ¥çœ‹ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æœ€åæ›´æ–°**: 2025-10-15
**ç»´æŠ¤è€…**: Claude Code
