增加相关推荐

标签管理。、

后台区分


每个页面的风格统一

每个页面加上搜索功能

搜索正文，搜索标签？

首页搜索



游戏活动板块
几个猜歌词游戏，几个投票。 


审核：
📋 审核系统设计方案
1️⃣ 整体架构
四层级的内容管理流程：
编辑发布 → 待审核列表 → 管理员审核 → 内容发布/拒绝
核心原则：
编辑/贡献者发布内容 → 状态为 pending（待审核）
管理员在后台审核 → 状态改为 approved（已通过） 或 rejected（已拒绝）
只有 approved 的内容才在前台显示
编辑者可以看到自己发布的内容和审核意见，但不能改动已发布的内容
2️⃣ 数据库设计
需要统一的审核字段（4个表）：
# 对应：Article、Schedule、Video、Gallery

review_status = Column(String(20), default='pending')
  # 值: pending(待审核) / approved(已通过) / rejected(已拒绝)

reviewer_id = Column(String(36), nullable=True)  # 审核人ID
review_notes = Column(Text, nullable=True)       # 审核备注/拒绝原因
reviewed_at = Column(DateTime, nullable=True)    # 审核时间
现状：
✅ Article 表已完全支持
✅ Schedule 表已有 review_status，需补充其他3个字段
❌ Video 和 Gallery 表需新增审核字段
3️⃣ 后端API设计
审核相关的API端点：
GET  /api/admin/reviews  # 获取待审核列表（分页，可按类型筛选）
POST /api/admin/reviews/{id}/approve  # 批准（需传入类型：article/video/schedule/gallery）
POST /api/admin/reviews/{id}/reject   # 拒绝（需传入 review_notes）
GET  /api/admin/reviews/{id}/detail   # 获取审核详情
筛选参数：
type: article | video | schedule | gallery
status: pending | approved | rejected
created_from / created_to: 日期范围
page / limit: 分页
4️⃣ 前端UI设计
新增一个"审核中心"页面： /admin/reviews 页面布局：
┌─────────────────────────────────────────────────┐
│ 审核中心         [筛选] [日期] [类型]          │
├─────────────────────────────────────────────────┤
│ 待审核: 12 | 已通过: 256 | 已拒绝: 3           │
├─────────────────────────────────────────────────┤
│                                                 │
│ [内容卡片列表]                                  │
│                                                 │
│ ┌─────────────────────────────────────────┐   │
│ │ 文章：春天来临了                         │   │
│ │ 作者：张三  时间：2025-10-30 10:20     │   │
│ │ 描述：这是一篇关于春天的散文...        │   │
│ │ 标签：季节 散文 自然                    │   │
│ │                    [查看详情] [审核]   │   │
│ └─────────────────────────────────────────┘   │
│                                                 │
└─────────────────────────────────────────────────┘
审核详情弹框：
┌──────────────────────────────────────┐
│ 审核：春天来临了          [X]        │
├──────────────────────────────────────┤
│                                      │
│ 作者：张三                           │
│ 类型：文章                           │
│ 创建时间：2025-10-30 10:20         │
│ 分类：峰言峰语 > 汪峰博客           │
│ 标签：季节、散文、自然               │
│                                      │
│ ─────────────────────────────────── │
│ 内容预览（可滚动）：                 │
│ [完整内容显示]                       │
│                                      │
│ ─────────────────────────────────── │
│ 审核意见：                           │
│ ┌─────────────────────────────────┐ │
│ │ [输入框]                        │ │
│ └─────────────────────────────────┘ │
│                                      │
│ [拒绝] [通过]                        │
└──────────────────────────────────────┘
5️⃣ 业务流程
发布时的逻辑：
// 编辑发布文章
if (currentRole === 'admin' || currentRole === 'super_admin') {
  // 管理员直接发布：review_status = 'approved'，is_published = true
  response = "发布成功！文章已在线。"
} else {
  // 编辑/贡献者发布：review_status = 'pending'，is_published = false
  response = "发布成功！内容已提交，待管理员审核。"
}
前台显示逻辑：
-- 前台只查询已通过的内容
SELECT * FROM articles WHERE review_status = 'approved' AND is_published = true
个人后台逻辑：
编辑看到自己的文章（无论什么状态）：
- PENDING：标签 🔔 待审核
- APPROVED：标签 ✅ 已发布
- REJECTED：标签 ❌ 被拒（显示拒绝原因）
6️⃣ 权限设计
super_admin 权限：
  ✅ 可以审核所有内容
  ✅ 可以查看所有待审核列表
  ✅ 可以直接发布（跳过审核）

admin 权限（可选）：
  ✅ 可以审核所有内容
  ✅ 可以查看所有待审核列表
  ✅ 可以直接发布（跳过审核）

editor/contributor 权限：
  ✅ 可以发布内容（进入待审核）
  ❌ 不能审核
  ❌ 只能看自己的内容状态
7️⃣ 实现步骤建议
第一阶段（必须）：
给 Video 和 Gallery 表添加审核字段
给 Schedule 表补充完整审核字段
编写审核API端点
修改发布逻辑（根据角色返回不同状态）
第二阶段（必须）：
构建审核中心前端页面
实现待审核内容卡片列表
实现审核详情弹框
实现批准/拒绝功能
第三阶段（可选）：
邮件/通知功能（审核完成时通知发布者）
审核日志（记录谁在什么时间审核了什么）
批量审核操作
导出审核报告
💡 我的建议
优先级顺序：
最重要：先实现基础审核系统（API + 审核中心页面）
重要：权限检查（确保非admin角色的内容需要审核）
可以延后：通知和日志功能
快速实现方案：
复用现有的 Article 审核代码到其他表
用一个统一的审核API处理所有类型
前端用同一个组件渲染不同类型的内容卡片
这个设计相对完整，你想从哪里开始实现呢？
用你的快速实现方案 实现第一阶段和第二阶段
好的，我来用快速实现方案完成第一和第二阶段。让我先创建一个任务列表来追踪进度：
Update Todos

添加审核字段到 Video 和 Gallery 模型

补充 Schedule 模型的完整审核字段

编写统一的审核 API 端点

修改发布逻辑 - 根据角色返回不同状态

构建审核中心前端页面

实现待审核内容卡片列表

实现审核详情弹框

实现批准/拒绝功能
现在开始第一阶段。首先给 Video 模型添加审核字段：
Read video.py