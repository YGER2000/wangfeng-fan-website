# 汪峰粉丝网站 - 开发维护计划

> 📅 **制定日期**: 2025-10-17
> 🎯 **目标**: 在不增加新功能的前提下，优化现有功能，统一风格，完善测试，为审核发布功能做准备

---

## 📊 现状分析

### ✅ 已完成的核心功能
1. **文章系统** - 完整的发布、编辑、列表、详情功能
2. **行程系统** - MySQL存储、图片上传、审核发布流程
3. **视频系统** - 发布、列表、详情页面
4. **图片系统** - 上传、编辑、列表管理
5. **标签系统** - 统一的标签管理和关联
6. **后台管理** - 两套后台（新旧）并存
7. **主题切换** - Light/Dark 双主题支持
8. **音乐播放** - 全局音乐播放器

### ⚠️ 存在的主要问题
1. **风格不统一** - 各页面UI设计差异较大
2. **未完成测试** - 功能较多但缺少系统测试
3. **后台重复** - 新旧两套后台系统并存（/admin 和 /admin-old）
4. **文档不全** - 部分功能缺少使用文档
5. **代码冗余** - 存在已删除但未清理的文件引用

---

## 🎯 优先级策略

根据你的情况（即将增加发布审核功能），建议优先关注以下方面：

### 🔴 **第一优先级：核心发布流程** （1-2周）
这些是审核发布功能的基础，必须先稳定

### 🟡 **第二优先级：用户界面统一** （2-3周）
提升整体专业度，减少用户困惑

### 🟢 **第三优先级：代码优化清理** （1-2周）
提高可维护性，减少技术债务

---

## 📋 详细执行计划

## 阶段一：核心发布流程稳定（第1-2周）

### 1. 文章管理系统 ⭐⭐⭐

#### 必须测试的页面：
- ✅ `/admin/articles/create` - 发布文章页面
- ✅ `/admin/articles/list` - 文章列表页面
- ✅ `/admin/articles/edit/:id` - 编辑文章页面
- ✅ `/article/:slug` - 文章详情页面（前台）

#### 需要检查的功能：
```
□ 发布流程
  □ 富文本编辑器工作正常
  □ 分类选择（一级+二级）正确关联
  □ 标签搜索和创建功能
  □ 发布日期选择
  □ 作者信息填写
  □ 摘要输入（可选）

□ 列表功能
  □ 搜索功能（标题、作者）
  □ 分类筛选
  □ 排序功能（标题、浏览量、发布时间）
  □ 编辑链接跳转

□ 编辑功能
  □ 加载现有文章数据
  □ 更新文章内容
  □ 保存后正确跳转

□ 详情页
  □ Slug路由正确解析
  □ 内容正确渲染（Markdown/MDX）
  □ 标签显示和点击
  □ 相关推荐（如已实现）
```

#### 需要统一的设计风格：
```
✓ 后台列表页 - 已按照 docs/后台列表设计方案.md 统一
✓ 后台发布页 - 已按照 docs/后台发布功能设计方案.md 统一
✗ 前台详情页 - 需要检查是否符合整体风格
```

---

### 2. 行程管理系统 ⭐⭐⭐

#### 必须测试的页面：
- ✅ `/admin/schedules/create` - 发布行程页面
- ✅ `/admin/schedules/list` - 行程列表页面
- ✅ `/admin/schedules/edit/:id` - 编辑行程页面
- ✅ `/tour-dates` - 行程展示页面（前台）

#### 需要检查的功能：
```
□ 发布流程
  □ 图片上传（原图+缩略图压缩）
  □ 日期三联选择器（年-月-日）
  □ 行程分类（8种）
  □ 城市和场馆填写
  □ 标签系统集成
  □ 提交后进入待审核状态

□ 审核发布流程 ⚠️ 重点测试
  □ 待审核行程列表显示
  □ 审核通过后自动创建文章
  □ 图片从 temp/ 移动到正式目录
  □ 缩略图自动生成（200KB以下）
  □ article_id 正确关联
  □ 状态徽章显示正确（待审核/已审核/已发布）

□ 前台展示
  □ 只显示已发布行程（is_published=1）
  □ 分类筛选功能
  □ 卡片弹窗显示
  □ "查看详情"按钮跳转到文章页
  □ 时间轴展示（如已实现）
```

#### 关键检查点：
```
⚠️ 行程文章自动生成逻辑（docs/行程信息实现方案.md）
  - 是否按照模板创建文章
  - 文章分类：资料科普 > 行程信息
  - Slug 生成规则：日期+主题前20字
  - 默认发布状态：已审核、已发布
```

---

### 3. 视频管理系统 ⭐⭐

#### 必须测试的页面：
- ✅ `/admin/videos/create` - 发布视频页面
- ✅ `/admin/videos/list` - 视频列表页面
- ✅ `/admin/videos/edit/:id` - 编辑视频页面
- ✅ `/video-archive` - 视频归档页面（前台）
- ✅ `/video/:id` - 视频详情页面（前台）

#### 需要检查的功能：
```
□ 发布流程
  □ B站视频链接解析（如已实现）
  □ 封面图自动获取/手动上传
  □ 视频分类选择
  □ 标签系统集成
  □ 发布日期选择

□ 列表管理
  □ 搜索功能
  □ 分类筛选
  □ 排序功能
  □ 编辑和删除操作

□ 前台展示
  □ 视频卡片展示
  □ 播放器嵌入（B站/YouTube等）
  □ 相关视频推荐
  □ 标签显示和点击
```

#### 已知问题修复：
```
⚠️ 根据 Todo/总体TODO.md:
  - B站视频封面存储重复问题
  - 检查是否有冗余存储
```

---

### 4. 图片管理系统 ⭐

#### 必须测试的页面：
- ✅ `/admin/gallery/upload` - 上传图片页面
- ✅ `/admin/gallery/list` - 图片列表页面
- ✅ `/admin/gallery/edit/:id` - 编辑图片页面
- ✅ `/gallery` - 图片画廊页面（前台）

#### 需要检查的功能：
```
□ 上传功能
  □ 单张/批量上传
  □ 图片压缩
  □ 标签系统集成
  □ 分类管理

□ 前台展示
  □ 瀑布流/网格布局
  □ 图片预览
  □ 标签筛选
  □ 懒加载
```

---

## 阶段二：用户界面统一（第3-5周）

### 1. 前台页面风格统一 ⭐⭐⭐

#### 需要检查的前台页面：

##### 📰 内容展示类页面
```
□ /feng-yan-feng-yu - 峰言峰语
  □ 使用新版组件（FengYanFengYuNew）
  □ 文章卡片样式统一
  □ 分类筛选功能
  □ 分页/加载更多

□ /feng-mi-liao-feng - 峰迷聊峰
  □ 使用新版组件（FengMiLiaoFengNew）
  □ 与峰言峰语风格一致

□ /shu-ju-ke-pu - 数据科普
  □ 使用新版组件（ShuJuKePuNew）
  □ 数据可视化展示
  □ 统计图表样式
```

##### 🎵 音乐相关页面
```
□ /discography - 唱片目录
  □ 专辑卡片展示
  □ 分类筛选（专辑/Live/新编/其他）
  □ 播放器集成
  □ 专辑详情弹窗

□ 全局音乐播放器
  □ 固定底部显示
  □ 播放列表管理
  □ 播放模式切换
  □ 音量控制
```

##### 📅 行程展示页面
```
□ /tour-dates - 演出行程
  □ 分类筛选（8种类型）
  □ 时间轴展示
  □ 卡片详情弹窗
  □ "查看详情"跳转
```

##### 🖼️ 视觉展示页面
```
□ /gallery - 图片画廊
  □ 响应式布局
  □ 图片懒加载
  □ 标签筛选
  □ 详情弹窗

□ /video-archive - 视频归档
  □ 视频卡片展示
  □ 分类筛选
  □ 播放统计
```

##### ℹ️ 信息展示页面
```
□ / - 首页
  □ Hero区域
  □ 最新动态
  □ 热门内容
  □ 统一配色

□ /about - 关于页面
  □ 人物介绍
  □ 成就展示
  □ 时间轴

□ /about-site - 关于网站
  □ 网站介绍
  □ 联系方式

□ /acting-career - 影视作品
  □ 作品列表
  □ 分类展示

□ /quotes - 语录精选
  □ 语录卡片
  □ 分类筛选
```

#### 统一检查清单：
```
所有前台页面需要统一的元素：

□ 主题色统一
  □ 汪峰紫 #8B5CF6 作为主色调
  □ Light/Dark 模式切换正常
  □ 按钮、链接、强调色一致

□ 布局统一
  □ Header 导航栏一致
  □ Footer 页脚一致
  □ 页面padding/margin 统一
  □ 响应式断点一致

□ 交互统一
  □ 悬停效果一致
  □ 动画效果统一（Framer Motion）
  □ 加载状态统一
  □ 空状态提示统一

□ 字体排版
  □ 标题层级（H1-H6）统一
  □ 正文字体大小统一
  □ 行高和间距统一
  □ 中英文字体搭配
```

---

### 2. 后台管理界面统一 ⭐⭐

#### 清理旧后台系统 ⚠️ 重要决策
```
当前状态：
  - /admin -> 新后台（NewAdminLayout）
  - /admin-old -> 旧后台（AdminLayout）

建议方案：
  1. 评估旧后台是否还在使用
  2. 迁移旧后台的有用功能到新后台
  3. 完全移除旧后台代码
  4. 清理 App.tsx 中的旧路由

涉及文件：
  - frontend/src/components/admin/AdminLayout.tsx
  - frontend/src/components/admin/pages/DashboardOverview.tsx
  - frontend/src/components/admin/pages/ReviewCenter.tsx
  - frontend/src/components/admin/pages/ScheduleManager.tsx
  - frontend/src/components/admin/pages/VideoManagement.tsx
  - frontend/src/components/admin/pages/UserManagement.tsx
  - frontend/src/components/admin/pages/SystemLogs.tsx
  - frontend/src/components/admin/pages/PlaceholderPage.tsx
```

#### 新后台页面检查
```
□ 侧边栏导航
  □ 菜单项分组清晰
  □ 图标显示正确
  □ 展开/折叠动画
  □ 当前页高亮

□ 顶部导航栏
  □ 网站Logo
  □ 返回主站链接
  □ 用户信息显示
  □ 退出按钮

□ 仪表盘页面
  □ 数据统计卡片
  □ 快捷入口
  □ 最近活动
  □ 图表可视化
```

---

### 3. 组件库统一 ⭐

#### 检查UI组件一致性
```
位置：frontend/src/components/ui/

□ 按钮组件
  □ 主要按钮样式
  □ 次要按钮样式
  □ 危险按钮样式
  □ 禁用状态

□ 表单组件
  □ 输入框样式
  □ 下拉菜单样式
  □ 文本域样式
  □ 日期选择器样式

□ 卡片组件
  □ 文章卡片
  □ 视频卡片
  □ 行程卡片
  □ 图片卡片

□ 模态框/弹窗
  □ 弹窗样式统一
  □ 关闭按钮位置统一
  □ 遮罩层样式统一

□ 标签组件
  □ TagList 显示样式
  □ TagInputWithSearch 输入样式
  □ TagContentModal 弹窗样式
```

---

## 阶段三：功能完善与测试（第6-7周）

### 1. 标签系统全面集成 ⭐⭐

根据 `docs/TAG_SYSTEM_GUIDE.md`，检查标签系统集成情况：

```
□ 后台管理
  ✅ 文章发布 - 已集成 TagInputWithSearch
  ✅ 行程发布 - 已集成 TagInputWithSearch
  ✅ 视频发布 - 需要确认是否已集成
  ✅ 图片上传 - 需要确认是否已集成

□ 前台展示
  □ 文章详情页 - 显示标签，点击跳转
  □ 行程详情页 - 显示标签，点击跳转
  □ 视频详情页 - 显示标签，点击跳转
  □ 图片详情页 - 显示标签，点击跳转

□ 标签聚合页面
  □ TagContentModal 弹窗
  □ 显示所有关联内容
  □ 按类型分组（文章/视频/图片/行程）
  □ 点击跳转到详情页
```

---

### 2. 搜索功能统一 ⭐

根据 `Todo/总体TODO.md`，需要为每个页面添加搜索功能：

```
□ 全局搜索（Header）
  □ 搜索框设计
  □ 搜索结果页面
  □ 搜索历史
  □ 热门搜索

□ 页面内搜索
  □ 文章列表搜索（标题、正文、标签）
  □ 行程列表搜索（主题、城市、场馆）
  □ 视频列表搜索（标题、描述）
  □ 图片列表搜索（标题、标签）

□ 搜索结果展示
  □ 关键词高亮
  □ 按类型分组
  □ 按相关度排序
  □ 分页加载
```

---

### 3. 审核发布流程完善 ⭐⭐⭐

为即将实现的审核发布功能做准备：

```
□ 数据库字段检查
  □ review_status 字段（pending/approved/rejected）
  □ is_published 字段（0/1）
  □ reviewer_id 字段（审核人ID）
  □ reviewed_at 字段（审核时间）
  □ review_comment 字段（审核备注）

□ 后台审核界面设计
  □ 待审核列表页面
  □ 审核详情页面
  □ 审核通过/拒绝按钮
  □ 审核历史记录

□ 审核流程测试
  □ 创建内容 -> 待审核状态
  □ 审核通过 -> 自动发布
  □ 审核拒绝 -> 退回修改
  □ 通知机制（可选）
```

---

### 4. 图片存储优化 ⭐⭐

根据 `Todo/总体TODO.md` 提到的"所有图片对象存储"：

```
□ 当前图片存储方案评估
  □ 本地存储：frontend/public/images/
  □ 临时文件：frontend/public/images/temp/
  □ 视频封面存储位置确认

□ 对象存储迁移方案（可选，长期规划）
  □ 选择云服务（阿里云OSS/腾讯云COS/七牛云）
  □ 上传接口改造
  □ CDN加速配置
  □ 图片URL替换

□ 图片管理优化
  □ 未使用图片清理
  □ 重复图片检测
  □ 图片压缩优化
  □ 存储空间统计
```

---

## 阶段四：代码优化与清理（第8周）

### 1. 删除废弃文件 ⭐

根据 git status 显示的已删除文件，清理相关引用：

```
□ 清理已删除的文档引用
  - DOCKER_GUIDE.md
  - SCHEDULE_MIGRATION_README.md
  - docs/角色权限设计方案.md
  - docs/后台管理规划.md

□ 清理已删除的组件引用
  - 旧版文章组件（AboutAwards, Biography, FengMiLiaoFeng, FengYanFengYu, ShuJuKePu等）
  - 旧版后台组件（PlaceholderAdmin, WriteArticle等）

□ 清理已删除的服务和模型
  - backend/app/core/local_db.py
  - backend/app/models/user.py
  - backend/app/services/schedule_service.py
  - backend/app/services/user_service.py

□ 清理已删除的脚本
  - delete_articles.py
  - docker-compose.yml
  - scripts/目录
```

---

### 2. 代码重构建议 ⭐

```
□ API调用统一
  □ 检查所有API调用是否使用 utils/api.ts
  □ 统一错误处理
  □ 统一Loading状态

□ 类型定义完善
  □ 检查所有组件的 TypeScript 类型
  □ 统一接口定义位置
  □ 导出公共类型

□ 样式优化
  □ 提取重复的 Tailwind 类到组件
  □ 统一配色变量
  □ 移除未使用的CSS
```

---

### 3. 性能优化 ⭐

```
□ 图片懒加载
  □ 画廊页面
  □ 文章列表
  □ 视频列表

□ 代码分割
  □ 路由懒加载
  □ 大组件按需加载

□ 缓存优化
  □ API响应缓存
  □ 静态资源缓存

□ 打包优化
  □ 检查打包大小
  □ 移除未使用的依赖
  □ 代码压缩
```

---

## 阶段五：测试与文档（第9-10周）

### 1. 功能测试 ⭐⭐⭐

```
□ 用户流程测试
  □ 访客浏览文章流程
  □ 访客查看行程流程
  □ 访客观看视频流程
  □ 访客浏览图片流程
  □ 管理员登录流程
  □ 管理员发布文章流程
  □ 管理员发布行程流程
  □ 管理员审核内容流程

□ 跨浏览器测试
  □ Chrome
  □ Firefox
  □ Safari
  □ Edge

□ 响应式测试
  □ 桌面端（1920px+）
  □ 笔记本（1366px）
  □ 平板（768px）
  □ 手机（375px）

□ 边界情况测试
  □ 空数据状态
  □ 长标题/长内容
  □ 特殊字符
  □ 大文件上传
  □ 网络错误
```

---

### 2. 文档完善 ⭐⭐

```
□ 用户使用文档
  □ 前台使用指南
  □ 搜索功能使用
  □ 标签功能使用

□ 管理员操作文档
  □ 后台登录指南
  □ 文章发布指南
  □ 行程发布指南
  □ 视频发布指南
  □ 图片上传指南
  □ 审核流程说明

□ 开发文档更新
  ✅ TAG_SYSTEM_GUIDE.md
  ✅ 行程信息实现方案.md
  ✅ 后台列表设计方案.md
  ✅ 后台发布功能设计方案.md
  □ API接口文档
  □ 数据库设计文档
  □ 部署指南
```

---

## 🔧 技术债务清单

### 高优先级
- [ ] 清理旧后台系统（/admin-old）
- [ ] 修复B站视频封面重复存储问题
- [ ] 统一所有页面的错误处���
- [ ] 完善行程审核后自动创建文章功能

### 中优先级
- [ ] 为所有列表页添加搜索功能
- [ ] 统一所有卡片组件样式
- [ ] 标签系统全面集成到前台展示
- [ ] 图片懒加载实现

### 低优先级
- [ ] 考虑对象存储迁移方案
- [ ] 性能监控和优化
- [ ] SEO优化
- [ ] 访问统计系统

---

## 🎯 里程碑

### 里程碑 1: 核心功能稳定 (第2周末)
- ✅ 文章、行程、视频、图片的发布编辑功能全部测试通过
- ✅ 行程审核发布流程完整可用
- ✅ 标签系统集成完成

### 里程碑 2: 界面风格统一 (第5周末)
- ✅ 所有前台页面风格统一
- ✅ 所有后台页面风格统一
- ✅ Light/Dark 主题完美适配
- ✅ 响应式设计完善

### 里程碑 3: 代码质量提升 (第8周末)
- ✅ 废弃代码清理完成
- ✅ 性能优化实施
- ✅ 代码重构完成
- ✅ 旧后台系统移除

### 里程碑 4: 测试与文档完善 (第10周末)
- ✅ 全流程功能测试通过
- ✅ 跨浏览器兼容测试通过
- ✅ 用户和管理员文档完善
- ✅ 开发文档更新

---

## 📝 每日工作建议

### 第一周重点：文章和行程系统
```
周一-周二：测试文章管理全流程
周三-周四：测试行程管理和审核流程
周五：测试行程自动创建文章功能
周末：修复发现的问题
```

### 第二周重点：视频和图片系统
```
周一-周二：测试视频管理全流程
周三-周四：测试图片管理全流程
周五：测试标签系统集成
周末：第一阶段总结
```

### 第三周重点：前台页面检查
```
周一-周二：检查内容展示类页面
周三-周四：检查音乐和行程页面
周五：检查信息展示类页面
周末：统一风格问题修复
```

### 第四周重点：后台界面优化
```
周一-周二：评估和清理旧后台
周三-周四：优化新后台界面
周五：测试后台所有功能
周末：第二阶段总结
```

---

## 🚨 风险提示

### 技术风险
1. **旧后台清理** - 可能影响部分功能，需要谨慎评估
2. **图片存储迁移** - 如果实施，需要做好数据备份
3. **代码重构** - 可能引入新bug，需要充分测试

### 时间风险
1. **测试时间** - 功能较多，全面测试可能超出预期
2. **bug修复** - 发现的问题可能比预期多
3. **文档编写** - 文档完善需要较多时间

### 建议
- 严格按优先级执行，不要贪多
- 每个阶段结束做好测试和备份
- 重要改动前创建git分支
- 保持与用户沟通，及时收集反馈

---

## ✅ 验收标准

### 阶段一验收
- [ ] 所有发布功能通过测试
- [ ] 审核流程完整可用
- [ ] 没有严重bug

### 阶段二验收
- [ ] 前后台风格统一
- [ ] 双主题完美切换
- [ ] 响应式设计无问题

### 阶段三验收
- [ ] 标签系统全面可用
- [ ] 搜索功能正常工作
- [ ] 审核流程准备就绪

### 阶段四验收
- [ ] 代码库整洁
- [ ] 性能指标达标
- [ ] 无废弃代码

### 阶段五验收
- [ ] 所有功能测试通过
- [ ] 文档齐全
- [ ] 可以开始审核功能开发

---

## 📞 需要决策的问题

1. **旧后台系统** - 是否完全删除？还是保留备用？
2. **对象存储** - 是否现在迁移？还是暂时使用本地存储？
3. **搜索功能** - 全文搜索还是简单匹配？是否需要搜索引擎？
4. **用户系统** - 是否需要用户注册登录？还是只有管理员？
5. **评论系统** - 是否需要评论功能？如何审核管理？

---

## 📚 参考文档

- `CLAUDE.md` - 项目总体说明
- `docs/行程信息实现方案.md` - 行程系统设计
- `docs/TAG_SYSTEM_GUIDE.md` - 标签系统指南
- `docs/后台列表设计方案.md` - 列表页面设计
- `docs/后台发布功能设计方案.md` - 发布页面设计
- `ADMIN_SYSTEM.md` - 后台管理系统文档
- `TODO.md` - 现有TODO列表

---

**最后更新**: 2025-10-17
**维护者**: Claude Code
**版本**: v1.0
